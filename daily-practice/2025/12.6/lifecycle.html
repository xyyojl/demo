<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vue 3 ç”Ÿå‘½å‘¨æœŸæ¼”ç¤º (No CLI)</title>
    <!-- 1. å¼•å…¥ Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .box { border: 1px solid #ccc; padding: 15px; margin: 10px; border-radius: 5px; }
        .parent { background-color: #f0f8ff; }
        .child { background-color: #ffe4e1; }
        button { cursor: pointer; padding: 5px 10px; margin-right: 5px; }
    </style>
</head>
<body>

    <div id="app"></div>

    <script>
        const { createApp, ref, onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted } = Vue;

        // --- å­ç»„ä»¶å®šä¹‰ ---
        const ChildComponent = {
            template: `
                <div class="box child">
                    <h3>ğŸ‘¶ æˆ‘æ˜¯å­ç»„ä»¶</h3>
                    <p>å­ç»„ä»¶æ•°æ®: {{ count }}</p>
                    <button @click="count++">æ›´æ–°å­ç»„ä»¶</button>
                </div>
            `,
            setup() {
                console.log('%c[Child] setup (ç›¸å½“äº created)', 'color: red');
                
                const count = ref(0);

                // æŒ‚è½½é˜¶æ®µ
                onBeforeMount(() => console.log('%c[Child] onBeforeMount', 'color: red'));
                onMounted(() => console.log('%c[Child] onMounted', 'color: red'));

                // æ›´æ–°é˜¶æ®µ
                onBeforeUpdate(() => console.log('%c[Child] onBeforeUpdate', 'color: red'));
                onUpdated(() => console.log('%c[Child] onUpdated', 'color: red'));

                // å¸è½½é˜¶æ®µ (æ³¨æ„ï¼šVue3 æ”¹åäº†ï¼Œä¸æ˜¯ destroy)
                onBeforeUnmount(() => console.log('%c[Child] onBeforeUnmount', 'color: red'));
                onUnmounted(() => console.log('%c[Child] onUnmounted', 'color: red'));

                return { count };
            }
        };

        // --- çˆ¶ç»„ä»¶å®šä¹‰ ---
        // å¯ä»¥é€šè¿‡æ³¨é‡Šæ‰å­ç»„ä»¶ï¼Œåªçœ‹å•ä¸ªç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ
        const ParentComponent = {
            components: { ChildComponent },
            template: `
                <div class="box parent">
                    <h2>ğŸ‘´ æˆ‘æ˜¯çˆ¶ç»„ä»¶</h2>
                    <button @click="showChild = !showChild">
                        {{ showChild ? 'é”€æ¯' : 'åˆ›å»º' }} å­ç»„ä»¶ (v-if)
                    </button>
                    <button @click="parentCount++">æ›´æ–°çˆ¶ç»„ä»¶</button>
                    <p>çˆ¶ç»„ä»¶æ•°æ®: {{ parentCount }}</p>
                    
                    <hr>
                    <!-- v-if è§¦å‘å­ç»„ä»¶çš„æŒ‚è½½ä¸å¸è½½ -->
                    <child-component v-if="showChild"></child-component>
                </div>
            `,
            setup() {
                console.log('%c[Parent] setup (ç›¸å½“äº created)', 'color: blue');

                const showChild = ref(true);
                const parentCount = ref(0);

                // æŒ‚è½½é˜¶æ®µ
                onBeforeMount(() => console.log('%c[Parent] onBeforeMount', 'color: blue'));
                onMounted(() => console.log('%c[Parent] onMounted', 'color: blue'));

                // æ›´æ–°é˜¶æ®µ
                onBeforeUpdate(() => console.log('%c[Parent] onBeforeUpdate', 'color: blue'));
                onUpdated(() => console.log('%c[Parent] onUpdated', 'color: blue'));

                return { showChild, parentCount };
            }
        };

        // å¯åŠ¨åº”ç”¨
        createApp(ParentComponent).mount('#app');
        /* 
        æ ¸å¿ƒç°è±¡åˆ†æ
        
        åœºæ™¯1:é¡µé¢åˆšåˆ·æ–°ï¼ˆåˆå§‹åŒ–åŠ è½½ï¼‰
        è¿™æ˜¯é¢è¯•æœ€é«˜é¢‘è€ƒç‚¹ï¼šçˆ¶å­ç»„ä»¶çš„æ‰§è¡Œé¡ºåºï¼ˆæ´‹è‘±æ¨¡å‹ï¼‰ã€‚
        
        æ§åˆ¶å°è¾“å‡ºé¡ºåºï¼š
        1. [Parent] setupï¼ˆçˆ¶åˆå§‹åŒ–ï¼‰
        2. [Parent] onBeforeMountï¼ˆçˆ¶å‡†å¤‡æŒ‚è½½ï¼‰
        3. [Child] setupï¼ˆå­åˆå§‹åŒ–ï¼‰
        4. [Child] onBeforeMountï¼ˆå­å‡†å¤‡æŒ‚è½½ï¼‰
        5. [Child] onMountedï¼ˆå­å…ˆæŒ‚è½½å®Œï¼ï¼‰
        6. [Parent] onMountedï¼ˆçˆ¶æœ€åæŒ‚è½½å®Œï¼‰

        ç†è§£ï¼šå°±åƒç›–æˆ¿å­ï¼Œå¿…é¡»å…ˆæŠŠé‡Œé¢çš„ç –å¤´ï¼ˆå­ç»„ä»¶ï¼‰ç Œå¥½ï¼Œæ•´é¢å¢™ï¼ˆçˆ¶ç»„ä»¶ï¼‰æ‰ç®—ç Œå®Œã€‚

        åœºæ™¯2:ç‚¹å‡»â€œæ›´æ–°çˆ¶ç»„ä»¶â€æŒ‰é’®
        
        æ§åˆ¶å°è¾“å‡ºé¡ºåºï¼š
        1. [Parent] onBeforeUpdateï¼ˆçˆ¶ç»„ä»¶æ•°æ®å‘ç”Ÿå˜åŒ–ï¼ŒDOM å°šæœªæ›´æ–°ï¼‰
        1. [Parent] onUpdatedï¼ˆçˆ¶ç»„ä»¶æ•°æ®å˜åŒ–ï¼ŒDOM æ›´æ–°åè°ƒç”¨ï¼‰

        æ³¨æ„ï¼šæ­¤æ—¶å­ç»„ä»¶ä¸ä¼šè§¦å‘ä»»ä½•é’©å­ï¼å› ä¸º Vue çš„æ›´æ–°æ˜¯ç»„ä»¶çº§åˆ«çš„ï¼Œçˆ¶å˜äº†å­ä¸ä¸€å®šå˜ã€‚

        åœºæ™¯ 3ï¼šç‚¹å‡»â€œé”€æ¯å­ç»„ä»¶â€ (v-if = false)
        è¿™æ˜¯è€ƒå¯Ÿ Vue 3 æ–°é’©å­å‘½åçš„åœ°æ–¹ã€‚

        æ§åˆ¶å°è¾“å‡ºé¡ºåºï¼š
        1. [Parent] onBeforeUpdateï¼ˆçˆ¶ç»„ä»¶è¦ç§»é™¤ DOM èŠ‚ç‚¹ï¼Œæ‰€ä»¥çˆ¶å…ˆåŠ¨ï¼‰
        2. [Child] onBeforeUnmountï¼ˆå­ç»„ä»¶å‡†å¤‡å¸è½½ï¼‰
        3. [Child] onUnmountedï¼ˆå­ç»„ä»¶å¸è½½å®Œæ¯•ï¼‰
        4. [Parent] onUpdatedï¼ˆçˆ¶ç»„ä»¶æ›´æ–°å®Œæ¯•ï¼‰

        */
    </script>
</body>
</html>